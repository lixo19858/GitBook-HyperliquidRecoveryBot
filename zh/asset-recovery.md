# 资产恢复功能

资产恢复是 Hyperliquid Recovery Bot 的核心功能，帮助用户从被标记为高风险的地址中安全地恢复数字资产。

## 🎯 功能概述

### 恢复原理
当 Hyperliquid 地址被标记为高风险时，用户无法通过官方前端界面进行操作。本机器人通过直接调用 Hyperliquid API，绕过前端限制，帮助用户恢复资产。

### 恢复流程
1. **资产分析**: 检测地址中的所有资产
2. **智能转换**: 将永续合约资产转换为现货资产
3. **安全提现**: 将资产提现到安全地址
4. **费用收取**: 按比例收取服务费

### 支持的恢复类型
- **现货资产恢复**: 直接提现现货资产
- **永续合约恢复**: 先转换为现货再提现
- **混合资产恢复**: 同时处理现货和永续合约资产

## 🚀 使用方法

### 启动恢复功能
```
方法一: 点击主菜单 🛠️ 资产恢复
方法二: 发送 /recovery 命令
方法三: 在检测结果页面点击 [开始恢复]
```

### 完整恢复流程

#### 步骤 1: 选择恢复方式
```
🛠️ 资产恢复功能

请选择操作方式:
[输入新地址] [使用检测过的地址] [从钱包选择]

💡 建议: 如果您刚完成地址检测，可以直接使用检测过的地址
```

#### 步骤 2: 地址确认
```
📍 确认恢复地址

地址: 0x1234567890123456789012345678901234567890
风险等级: 高风险
总资产价值: $1,234.56

是否确认使用此地址进行恢复？
[确认] [重新输入] [取消]
```

#### 步骤 3: 私钥输入
```
🔐 私钥验证

请输入该地址对应的私钥（不包含 0x 前缀）:

⚠️ 安全提示:
• 私钥仅用于资产恢复操作
• 操作完成后会立即清理
• 请确保在安全环境下输入
• 不要截图或复制私钥到其他地方

私钥格式示例:
1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef

[输入私钥] [取消操作]
```

#### 步骤 4: 私钥验证
```
🔍 正在验证私钥...

✅ 私钥格式验证通过
✅ 私钥与地址匹配确认
✅ 账户访问权限验证通过

继续进行资产分析...
```

#### 步骤 5: 资产分析
```
📊 正在分析资产...

🔍 检测到以下资产:

现货资产 (Spot):
• USDC: 500.00 ($500.00)
• ETH: 0.5 ($734.56)
• BTC: 0.001 ($45.00)

永续合约 (Perp):
• USDC 保证金: 200.00 ($200.00)
• ETH-USD 持仓: 0.1 ETH (需要平仓)
• 未实现盈亏: +$15.50

💰 总资产价值: $1,495.06
🔄 需要转换的资产: $215.50 (永续合约)
```

#### 步骤 6: 恢复计划确认
```
📋 资产恢复计划

🎯 恢复策略: 全自动恢复
💰 总资产价值: $1,495.06
🏦 服务费 (0.5%): $7.48
💵 预计到账: $1,487.58

📝 执行步骤:
1. ✅ 资产分析完成
2. 🔄 平仓永续合约持仓
3. 🔄 转移永续合约保证金到现货
4. 🔄 提现所有现货资产
5. 🔄 收取服务费
6. 🔄 清理临时数据

⏱️ 预估执行时间: 3-8 分钟
🎯 目标地址: 将自动生成安全地址

⚠️ 重要提示:
• 操作开始后无法撤销
• 请确保网络连接稳定
• 建议在网络较好的环境下操作

确认执行恢复操作？
[确认恢复] [修改计划] [取消操作]
```

#### 步骤 7: 执行恢复
```
🚀 开始执行恢复操作...

步骤 1/5: 准备恢复环境
✅ 初始化恢复参数
✅ 验证网络连接
✅ 检查账户状态

步骤 2/5: 处理永续合约
🔄 正在平仓 ETH-USD 持仓...
✅ ETH-USD 持仓平仓完成
🔄 正在转移保证金到现货账户...
✅ 保证金转移完成

步骤 3/5: 提现现货资产
🔄 正在提现 USDC (715.50)...
✅ USDC 提现完成 (TxHash: 0xabc...123)
🔄 正在提现 ETH (0.6)...
✅ ETH 提现完成 (TxHash: 0xdef...456)
🔄 正在提现 BTC (0.001)...
✅ BTC 提现完成 (TxHash: 0x789...abc)

步骤 4/5: 收取服务费
🔄 正在收取服务费...
✅ 服务费收取完成 ($7.48)

步骤 5/5: 清理和确认
✅ 清理临时数据
✅ 验证所有交易
✅ 生成恢复报告

🎉 恢复操作完成！
```

#### 步骤 8: 恢复结果
```
✅ 资产恢复成功！

📊 恢复摘要:
┌─────────────────────────────────┐
│ 恢复详情                         │
├─────────────────────────────────┤
│ 源地址: 0x1234...7890           │
│ 目标地址: 0x5678...1234         │
│ 恢复时间: 2024-01-15 14:35:42   │
│ 执行时长: 4 分 23 秒             │
└─────────────────────────────────┘

💰 恢复资产明细:
• USDC: 708.02 (原 715.50 - 服务费 7.48)
• ETH: 0.6 (原 0.5 + 平仓收益 0.1)
• BTC: 0.001

🧾 费用明细:
• 总资产价值: $1,495.06
• 服务费率: 0.5%
• 服务费金额: $7.48
• 网络手续费: 已包含在服务费中

🔗 交易记录:
• USDC 提现: 0xabc...123 ✅ 已确认
• ETH 提现: 0xdef...456 ✅ 已确认  
• BTC 提现: 0x789...abc ✅ 已确认

📱 后续操作:
[查看目标地址] [下载恢复报告] [返回主菜单]

感谢使用 Hyperliquid Recovery Bot！
您的资产已安全转移到新地址。
```

## 💰 费用结构详解

### 服务费计算
- **基础费率**: 0.5% (按恢复资产总价值计算)
- **最低费用**: 1 USDC
- **最高费用**: 100,000,000 USDC

### 费用计算示例
```
示例 1: 恢复金额 $100
服务费 = max($100 × 0.5%, $1) = $1.00

示例 2: 恢复金额 $1,000  
服务费 = $1,000 × 0.5% = $5.00

示例 3: 恢复金额 $10,000
服务费 = $10,000 × 0.5% = $50.00

示例 4: 恢复金额 $1,000,000
服务费 = $1,000,000 × 0.5% = $5,000.00
```

### 费用包含内容
- **恢复服务费**: 资产恢复操作费用
- **网络手续费**: 区块链交易手续费
- **技术服务费**: 技术支持和维护费用
- **风险保障费**: 操作风险保障费用

### 费用收取方式
- **自动扣除**: 从恢复的资产中自动扣除
- **优先级**: USDC > ETH > BTC > 其他代币
- **透明计费**: 所有费用在操作前明确显示
- **无隐藏费用**: 不收取任何额外费用

## 🔒 安全保障

### 私钥安全
```
🔐 私钥安全措施:

1. 加密存储:
   • 使用 AES-256 加密算法
   • 随机生成加密密钥
   • 内存中临时存储

2. 访问控制:
   • 仅恢复过程中使用
   • 严格的权限控制
   • 操作日志记录

3. 自动清理:
   • 操作完成后立即清理
   • 内存数据覆写
   • 无持久化存储
```

### 操作安全
```
🛡️ 操作安全机制:

1. 多重验证:
   • 地址格式验证
   • 私钥匹配验证
   • 资产状态验证

2. 风险控制:
   • 操作金额限制
   • 频率限制控制
   • 异常行为检测

3. 回滚机制:
   • 操作失败自动回滚
   • 部分成功状态处理
   • 错误恢复机制
```

### 资产安全
```
💎 资产安全保障:

1. 目标地址:
   • 自动生成安全地址
   • 用户可指定目标地址
   • 地址有效性验证

2. 交易确认:
   • 等待区块确认
   • 交易状态监控
   • 失败重试机制

3. 资产追踪:
   • 完整的操作记录
   • 交易哈希记录
   • 资产流向追踪
```

## ⚠️ 重要注意事项

### 操作前准备
1. **网络环境**: 确保网络连接稳定
2. **设备安全**: 在安全的设备上操作
3. **私钥准备**: 确保私钥正确且可用
4. **时间安排**: 预留足够的操作时间

### 操作中注意
1. **不要关闭**: 操作过程中不要关闭 Telegram
2. **保持连接**: 保持网络连接稳定
3. **不要干扰**: 不要进行其他区块链操作
4. **耐心等待**: 某些步骤可能需要较长时间

### 操作后确认
1. **检查结果**: 仔细检查恢复结果
2. **验证交易**: 在区块链浏览器中验证交易
3. **保存记录**: 保存重要的交易记录
4. **安全清理**: 清理相关的敏感信息

## 🔧 高级选项

### 自定义目标地址
```
🎯 目标地址设置

当前设置: 自动生成安全地址

选项:
[使用自动生成地址] [指定目标地址] [从钱包选择]

如选择指定目标地址:
请输入目标地址: 0x...

⚠️ 注意: 请确保目标地址安全且由您控制
```

### 分批恢复
```
📦 分批恢复设置

当前资产价值: $10,000
建议分批数量: 2 批

分批方案:
批次 1: $5,000 (USDC + ETH)
批次 2: $5,000 (BTC + 其他)

优势:
• 降低单次操作风险
• 提高操作成功率
• 便于资产管理

[使用分批恢复] [一次性恢复]
```

### 恢复计划定制
```
⚙️ 恢复计划定制

标准计划: 全自动恢复 (推荐)
自定义计划: 手动选择恢复步骤

自定义选项:
☑️ 平仓永续合约持仓
☑️ 转移保证金到现货
☑️ 提现现货资产
☑️ 收取服务费

高级选项:
□ 保留部分资产
□ 指定提现顺序
□ 设置滑点保护

[使用标准计划] [自定义计划]
```

## 📊 恢复统计

### 个人恢复记录
```
📈 我的恢复记录

总恢复次数: 3 次
总恢复金额: $15,678.90
总服务费: $78.39
平均恢复时间: 4 分 32 秒

最近恢复:
1. 2024-01-15 - $1,495.06 ✅ 成功
2. 2024-01-10 - $8,234.50 ✅ 成功
3. 2024-01-05 - $5,949.34 ✅ 成功

[查看详情] [下载报告]
```

### 系统恢复统计
```
🌐 系统统计

今日恢复:
• 恢复次数: 156 次
• 恢复金额: $2,345,678.90
• 成功率: 99.2%

历史统计:
• 总恢复次数: 12,345 次
• 总恢复金额: $123,456,789.01
• 平均恢复金额: $10,003.45
```

## 🆘 故障排除

### 常见问题及解决方案

#### Q: 私钥验证失败
```
❌ 可能原因:
1. 私钥格式错误 (包含0x前缀)
2. 私钥与地址不匹配
3. 私钥长度不正确

✅ 解决方案:
1. 检查私钥格式 (64位十六进制)
2. 确认私钥对应正确地址
3. 重新输入私钥
```

#### Q: 恢复操作失败
```
❌ 可能原因:
1. 网络连接不稳定
2. Hyperliquid API 暂时不可用
3. 账户状态异常

✅ 解决方案:
1. 检查网络连接
2. 稍后重试操作
3. 联系技术支持
```

#### Q: 部分资产恢复失败
```
❌ 可能原因:
1. 某些资产正在使用中
2. 网络拥堵导致交易失败
3. 资产余额不足支付手续费

✅ 解决方案:
1. 检查资产状态
2. 等待网络恢复后重试
3. 确保有足够余额支付费用
```

### 紧急联系方式
如果遇到严重问题，请立即联系技术支持：
- **机器人内反馈**: 使用机器人的反馈功能
- **紧急情况**: 详细描述问题和操作步骤
- **提供信息**: 地址、时间、错误信息等
